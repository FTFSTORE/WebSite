<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nota Fiscal</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            color: #333;
            background-color: #f4f4f4;
        }
        .container {
            background-color: #fff;
            max-width: 700px;
            margin: 0 auto;
            border: 2px solid #3488b2;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        .invoice-header {
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 20px;
            border-bottom: 2px solid #3488b2;
            padding-bottom: 10px;
        }
        .invoice-header img {
            max-width: 120px;
            border-radius: 10px;
            border: 3px solid #3488b2;
        }
        .invoice-header h1 {
            font-size: 36px;
            color: #3488b2;
        }
        .invoice-content {
            margin-top: 20px;
        }
        .invoice-content h2 {
            font-size: 24px;
            margin-bottom: 15px;
            color: #3488b2;
        }
        .invoice-content p {
            margin: 8px 0;
            color: #666;
        }
        .invoice-content strong {
            color: #3488b2;
        }
        .invoice-termos {
            margin-top: 20px;
            border-top: 2px solid #3488b2;
            padding-top: 10px;
        }
        .invoice-termos h3 {
            font-size: 20px;
            color: #3488b2;
        }
        .invoice-termos p {
            margin: 8px 0;
            color: #666;
        }
        .invoice-footer {
            margin-top: 20px;
            border-top: 2px solid #3488b2;
            padding-top: 10px;
        }
        .invoice-footer p {
            margin: 4px 0;
            color: #666;
        }
        button {
            padding: 12px 20px;
            font-size: 18px;
            background-color: #3488b2;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 20px;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #2a6a8a;
        }
        .points-accumulated {
            margin-top: 10px;
            font-size: 18px;
            color: #3488b2;
        }
    </style>
</head>
<body>
    <div class="container" id="invoice">
        <div class="invoice-header">
            <img src="FTF (3).png" alt="Logo da Marca"> <!-- Adicione sua logo aqui -->
            <h1>Nota Fiscal</h1>
        </div>
        <div class="invoice-content" id="invoice-content">
            <!-- O conteúdo da nota fiscal será inserido aqui -->
        </div>
        <div class="invoice-termos">
            <h3>Termos e Condições</h3>
            <p>
                1. A nota fiscal emitida é a confirmação da sua compra e deve ser guardada para resgatar pontos.
            </p>
            <p>
                2. Ao acumular pontos suficientes, você pode resgatar um produto com o mesmo número de pontos acumulados.
            </p>
            <p>
                3. A empresa reserva-se o direito de modificar os termos e condições sem aviso prévio. As alterações aplicam-se a futuras transações e não afetam os termos já aceitos.
            </p>
            <p>
                4. É responsabilidade do cliente verificar os dados informados na nota fiscal no momento da compra. Qualquer erro deve ser comunicado imediatamente.
            </p>
            <p>
                5. Para dúvidas ou suporte, entre em contato conosco através do canal de atendimento no Discord.
            </p>
        </div>
        <div class="invoice-footer">
            <p><strong>Empresa:</strong> FTF STORE - DISCORD</p>
            <p><strong>Data:</strong> <span id="date"></span></p>
            <p><strong>Número da NF:</strong> <span id="invoice-number"></span></p>
            <p class="points-accumulated" id="points-accumulated"></p>
        </div>
    </div>
    <button onclick="captureScreenshot()">Tire Print</button>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script>
       window.onload = function() {
    // Recuperar dados do localStorage
    const name = localStorage.getItem('name');
    const productDetails = localStorage.getItem('productDetails');
    const totalPrice = parseFloat(localStorage.getItem('totalPrice'));

    // Gerar número da nota fiscal (simples número sequencial ou aleatório)
    const invoiceNumber = `NF-${Math.floor(Math.random() * 1000000)}`;

    // Calcular pontos acumulados (60 pontos a cada R$5)
    const pointsAccumulated = Math.floor(totalPrice / 10) * 60;

    // Exibir dados na página
    const invoiceContent = document.getElementById('invoice-content');
    invoiceContent.innerHTML = `
        <h2>Detalhes da Nota Fiscal</h2>
        <p><strong>Nome:</strong> ${name}</p>
        <div>${productDetails}</div>
        <p><strong>Valor Total:</strong> R$${totalPrice.toFixed(2)}</p>
        <p class="points-accumulated"><strong>Pontos Acumulados:</strong> ${pointsAccumulated}p</p>
    `;

    // Adicionar a data atual e o número da nota fiscal
    const date = new Date().toLocaleDateString('pt-BR');
    document.getElementById('date').textContent = date;
    document.getElementById('invoice-number').textContent = invoiceNumber;
};

function captureScreenshot() {
    html2canvas(document.getElementById('invoice')).then(canvas => {
        const link = document.createElement('a');
        link.href = canvas.toDataURL('image/png');
        link.download = `NF.FTF_STORE.png`;
        link.click();

        // Redirecionar para a página de carregamento
        window.location.href = 'loading2.html';
        
        // Limpar dados do localStorage após redirecionar para a página de carregamento
        setTimeout(() => {
            localStorage.removeItem('name');
            localStorage.removeItem('productDetails');
            localStorage.removeItem('totalPrice');
        }, 4000); // Adiciona um pequeno atraso para garantir que o redirecionamento aconteça primeiro
    });
}

    </script>
</body>
</html>
